# おてつだいコイン

お子様のお手伝いを記録して、コインを獲得し、お小遣い管理ができるiOSアプリです。

## 概要

おてつだいコインは、子供たちのお手伝いを楽しく記録し、モチベーションを向上させるためのアプリです。SwiftUIとCore Dataを使用したMVVM + クリーンアーキテクチャで開発されており、@Observableパターンによる最新の状態管理を採用しています。

## 主な機能

### 🏠 ホーム画面
- お子様の今月の獲得コイン数表示
- 月間お手伝い回数の確認
- 最近のお手伝い履歴の表示
- お子様ごとの成績を一覧で確認
- スプラッシュスクリーンによる快適な起動体験

### 📝 お手伝い記録
- 簡単な操作でお手伝いの記録
- お子様とお手伝いタスクを選択
- 記録時にコイン獲得アニメーション
- 効果音と触覚フィードバックでお子様のモチベーション向上
- 記録の編集・修正機能

### 👨‍👩‍👧‍👦 お子様管理
- 複数のお子様を登録・管理
- お子様ごとのテーマカラー設定
- アイコン表示で視覚的に分かりやすい
- お子様の追加・編集・削除機能

### 📋 お手伝いタスク管理
- お手伝いタスクの追加・編集
- タスクごとのコイン値設定
- アクティブ/非アクティブの切り替え
- カスタマイズ可能なタスクリスト

### 📊 履歴表示
- 期間別のお手伝い履歴表示
  - 今週
  - 今月
  - 過去3ヶ月
  - 全期間
- お子様別での履歴フィルタリング
- 獲得コイン数の詳細表示

### 💰 お小遣い管理（新機能）
- **月別お小遣い計算**: 獲得コインに基づく自動計算
- **支払い管理**: 月別のお小遣い支払い記録
- **月別履歴ビュー**: 詳細な月別成績と支払い状況
- **支払い確認機能**: ワンタップでお小遣い支払い
- **自動月末処理**: MonthlyResetServiceによる月次データ管理

### ✏️ 記録編集機能（新機能）
- 既存のお手伝い記録の編集・修正
- 記録日時の変更
- タスク内容の変更
- 記録の削除機能

### 🎓 チュートリアル
- 初回利用時の丁寧な操作説明
- お子様登録からお手伝い記録までのガイド
- いつでも再表示可能
- 段階的な学習でスムーズな導入

## 使用方法

### 1. 初期設定

#### お子様の登録
1. 設定画面を開く
2. 「新しい子供を追加」をタップ
3. お子様の名前とテーマカラーを入力
4. 保存ボタンをタップ

#### お手伝いタスクの設定
1. 設定画面の「お手伝いリストを編集」をタップ
2. 「新しいタスクを追加」をタップ
3. タスク名とコイン値を入力
4. 保存ボタンをタップ

### 2. お手伝いの記録

1. 記録タブを選択
2. お手伝いをしたお子様を選択
3. 完了したお手伝いタスクを選択
4. 「記録する」ボタンをタップ
5. コイン獲得アニメーションを確認

### 3. 履歴の確認

1. ホーム画面で月間成績を確認
2. 履歴タブで詳細な記録を表示
3. 期間とお子様でフィルタリング
4. 各記録の詳細情報を確認

### 4. お小遣い管理（新機能）

#### 月別履歴の確認
1. ホーム画面から「月別履歴」をタップ
2. 月別のお手伝い実績とお小遣い額を確認
3. 各月の詳細を展開して記録を確認

#### お小遣いの支払い
1. 月別履歴で未払いの月を選択
2. 詳細を展開して「お小遣いを支払う」をタップ
3. 確認ダイアログで「支払う」を選択
4. 支払い記録が自動で保存される

### 5. 記録の編集（新機能）

#### お手伝い記録の修正
1. 履歴画面で編集したい記録をタップ
2. 記録編集画面で内容を修正
3. 日時、タスク内容を変更可能
4. 保存ボタンで変更を確定

### 6. 設定の変更

#### お子様情報の編集
1. 設定画面でお子様の行をタップ
2. メニューから「編集」を選択
3. 情報を変更して保存

#### お手伝いタスクの編集
1. 設定画面の「お手伝いリストを編集」をタップ
2. 編集したいタスクをタップ
3. 情報を変更して保存

## 開発者向け機能（DEBUGビルドのみ）

### サンプルデータ管理

開発・デバッグ用の機能として、以下の機能が利用可能です：

#### 3ヶ月分サンプルデータ生成
- 子供2人（太郎・花子）を自動作成
- 6種類のお手伝いタスクを自動作成
- 過去3ヶ月分のランダムなお手伝い記録を生成
- 月またぎの表示確認に最適

#### データ削除機能
- **記録データのみ削除**: お手伝い記録のみを削除（子供・タスクは保持）
- **全データ削除**: すべてのデータを削除してクリーンな状態に

### 使用方法
1. 設定画面を開く
2. 「開発者向け」セクションを確認
3. 必要な機能をタップして実行

**注意**: これらの機能はDEBUGビルドでのみ利用可能で、リリースビルドには含まれません。

## 技術仕様

- **フレームワーク**: SwiftUI, Core Data
- **アーキテクチャ**: MVVM + クリーンアーキテクチャ
- **状態管理**: @Observable（@MainActor/@Publishedから移行済み）
- **永続化**: Core Data + Repository パターン
- **依存性注入**: RepositoryFactory + ViewModelFactory
- **テスト**: XCTest, ViewInspector
- **音響効果**: AVFoundation（SoundService）
- **触覚フィードバック**: UIKit Haptics
- **アクセシビリティ**: Dynamic Type, High Contrast対応
- **最小対応OS**: iOS 18.5+

## 主要な特徴

### アーキテクチャ設計
- **@Observable**: SwiftUIネイティブな状態管理（最新パターン）
- **Repository パターン**: データアクセスの完全な抽象化
- **依存性注入**: RepositoryFactory, ViewModelFactoryによる高度なDI
- **MVVM**: ビューとビジネスロジックの完全分離
- **クリーンアーキテクチャ**: Data/Domain/Presentation層の明確な分離

### ユーザーエクスペリエンス
- **直感的なUI**: 子供にも分かりやすいインターフェース
- **マルチモーダルフィードバック**: アニメーション、効果音、触覚フィードバック
- **テーマカラー**: お子様ごとの個性化
- **レスポンシブデザイン**: 様々な画面サイズに対応
- **アクセシビリティ**: 視覚・聴覚サポート機能

### データ管理
- **自動保存**: リアルタイムでのデータ永続化
- **データ整合性**: Core Dataによる堅牢なデータ管理
- **月次自動処理**: MonthlyResetServiceによる自動月末処理
- **履歴追跡**: 詳細な記録と統計情報
- **包括的エラーハンドリング**: ErrorMessageConverterによる適切なエラー処理

### 新しい機能群
- **お小遣い管理システム**: AllowanceCalculator + AllowancePayment
- **記録編集機能**: HelpRecordEditViewModel + HelpRecordEditView
- **月別履歴管理**: MonthlyHistoryViewModel + MonthlyHistoryView
- **チュートリアルシステム**: TutorialService + 段階的ガイダンス
- **サンプルデータ生成**: SampleDataService（開発・テスト用）

## 開発プロセス

### アーキテクチャ移行（完了済み）
- @MainActor/@Publishedから@Observableへの移行完了
- Repository + Factory パターンによる高度な依存性注入実装
- より簡潔で高性能な状態管理を実現
- SwiftUIとの統合を最適化

### 最新の開発成果
- **お小遣い管理システム**: 完全な月別お小遣い計算・支払い機能
- **記録編集システム**: 既存データの修正・編集機能
- **月別履歴システム**: 詳細な月別データ表示・管理
- **包括的UX向上**: 音響・触覚フィードバック、アクセシビリティ対応
- **自動化システム**: 月末処理の自動化

### テスト戦略
- TDD（テスト駆動開発）の採用
- 単体テスト、統合テスト、UIテストの実装
- ViewInspectorを使用したSwiftUIテスト
- パフォーマンステスト（benchmark-tests.sh）
- 継続的インテグレーションによる品質保証

### コード品質
- クリーンアーキテクチャの厳格な実装
- SOLID原則の遵守
- 包括的なエラーハンドリング
- アクセシビリティ標準への準拠

## ライセンス

このプロジェクトは開発中のため、ライセンスは未定です。

## 貢献

現在このプロジェクトは開発中です。貢献についてのガイドラインは後日追加予定です。